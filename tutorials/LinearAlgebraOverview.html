

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Linear Algebra Overview &#8212; Rapaio Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pdf_print.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/LinearAlgebraOverview';</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tensors and Neural Networks" href="NeuralNetworks.html" />
    <link rel="prev" title="Reading and Writing data" href="ReadingAndWritingData.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Rapaio Book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Rapaio Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Rapaio Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../BriefPreview.html">Brief preview</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuiltinDataSets.html">Built-in Data sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Variables.html">Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataHandlingOverview.html">Data Handling Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="CoreStatisticalTools.html">Core statistical tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="DataVisualization.html">Data visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadingAndWritingData.html">Reading and Writing data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Linear Algebra Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="NeuralNetworks.html">Tensors and Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/KMeans.html">Algorithms: KMeans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tutorials/LinearAlgebraOverview.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear Algebra Overview</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#darraymanager">DArrayManager</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shape-of-a-darray">Shape of a DArray</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#darray-creation">DArray creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stride-arrays">Stride arrays</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-iterators">Data iterators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operations-on-shapes">Operations on shapes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-interesting-case-of-stride-0">The interesting case of stride 0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unary-operations">Unary operations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduce-operations">Reduce operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gather-and-scatter">Gather and scatter</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-operations">Binary operations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">Broadcasting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-decompositions">Matrix decompositions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further reading</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="linear-algebra-overview">
<h1>Linear Algebra Overview<a class="headerlink" href="#linear-algebra-overview" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">load</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">rapaio</span><span class="o">-</span><span class="n">bootstrap</span><span class="p">.</span><span class="na">ipynb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adding dependency <span class=" -Color -Color-Bold -Color-Bold-Green">io.github.padreati:rapaio-lib:7.0.1</span>
Solving dependencies
Resolved artifacts count: 1
Add to classpath: <span class=" -Color -Color-Green">/home/ati/work/rapaio-jupyter-kernel/target/mima_cache/io/github/padreati/rapaio-lib/7.0.1/rapaio-lib-7.0.1.jar</span>

</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DArrays</span></code> are multi-dimensional arrays which stores data elements of the same type indexed by dimensions. Current implementation offers only stride dense vector arrays, but the design allows future implementations like sparse arrays.</p>
<p>DArrays offers many operations, besides standard manipulation data tools, there are implemented also some non trivial operations and also matrix decompositions and linear solvers. There are implementations for four numerical data types: <code class="docutils literal notranslate"><span class="pre">byte</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p>
<section id="darraymanager">
<h2>DArrayManager<a class="headerlink" href="#darraymanager" title="Permalink to this heading">#</a></h2>
<p>Working with darrays starts with having a <code class="docutils literal notranslate"><span class="pre">DArrayManager</span></code>. A DArrayManager handles all the internals which are required for an implementation of DArrays. Even if there is a single implementation of DArrays, which works with standard Java arrays and uses stride algebra and simd vectorization, multiple implementations are possible. One example is to use MemorySegments when simd instructions will be able to work with indexed operations.</p>
<p>DArray manager describes which storage factory to be used, which implementation of the operations, and other various parameters.</p>
<p>One can create darrays with this tensor manager using also <code class="docutils literal notranslate"><span class="pre">DArrays</span></code> class. However it is advisable to use a DArrayManager every time since this will maintain code compatbility in the future when new DArray implementations will be available. Switching to other implementations will require a single line of code change, where you choose the DArrayManager implementation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">DArrayManager</span><span class="w"> </span><span class="n">dm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DArrayManager</span><span class="p">.</span><span class="na">base</span><span class="p">();</span>
<span class="n">DType</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DType</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="shape-of-a-darray">
<h2>Shape of a DArray<a class="headerlink" href="#shape-of-a-darray" title="Permalink to this heading">#</a></h2>
<p>DArray elements are indexed by dimensions. You can think of a darray as a hypercube of data elements with one element in each position of the hypercube. A darray can have 0, 1, 2 or more dimensions. Each dimension have a dimension size. The dimensions and the size of each dimension is described by a <code class="docutils literal notranslate"><span class="pre">Shape</span></code> object.</p>
<p>The total number of elements is given by the product of all dimension sizes, or 1 if there is no dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// a shape with no dimensions</span>
<span class="n">println</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">());</span>

<span class="c1">// a shape with 1 dimension / a vector of size 1</span>
<span class="n">println</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>

<span class="c1">// Both shapes are of size 1, but they are different shapes</span>
<span class="n">println</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">().</span><span class="na">size</span><span class="p">());</span>
<span class="n">println</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">size</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape: []
Shape: [1]
1
1
</pre></div>
</div>
</div>
</div>
</section>
<section id="darray-creation">
<h2>DArray creation<a class="headerlink" href="#darray-creation" title="Permalink to this heading">#</a></h2>
<p>A darray with no dimensions is a scalar and can be created with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">scalar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">scalar</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="mf">1.</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">scalar</span><span class="p">.</span><span class="na">shape</span><span class="p">());</span>
<span class="n">println</span><span class="p">(</span><span class="n">scalar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape: []
BaseStride{DOUBLE,[],0,[]}
 1  
</pre></div>
</div>
</div>
</div>
<p>A DArray with a single dimension is a vector, with two dimensions it is called a matrix and in general with more than two dimensions it is called a tensor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span><span class="p">.</span><span class="na">seq</span><span class="p">(</span><span class="n">DType</span><span class="p">.</span><span class="na">FLOAT</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">100</span><span class="p">)).</span><span class="na">printFullContent</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 ] 
</pre></div>
</div>
</div>
</div>
<p>Since the default darray manager uses Java arrays as data storage, it is possible to wrap an array into a darray of appropriate type and use darray operations to change values in the array. For example we will create an array of double values and a wrapper darray around it.
Using darray methods we can change the values from the array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">double</span><span class="o">[]</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">double</span><span class="o">[]</span><span class="w"> </span><span class="p">{</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="p">,</span><span class="w"> </span><span class="mf">3.</span><span class="p">};</span>
<span class="c1">// the default tensor manager wraps a double array if we request a Tensor&lt;Double&gt;</span>
<span class="kd">var</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">stride</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">array</span><span class="p">);</span>
<span class="n">t</span><span class="p">.</span><span class="na">log1p_</span><span class="p">();</span><span class="w"> </span><span class="c1">// call the in-place log1p operation</span>
<span class="n">Arrays</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span><span class="n">array</span><span class="p">).</span><span class="na">forEach</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">::</span><span class="n">println</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6931471805599453
1.0986122886681096
1.3862943611198906
</pre></div>
</div>
</div>
</div>
<p>The same thing happens for other value types (from the supperted ones which are: <code class="docutils literal notranslate"><span class="pre">double</span></code>,<code class="docutils literal notranslate"><span class="pre">float</span></code>,<code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">byte</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="o">[]</span><span class="w"> </span><span class="n">floatArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">float</span><span class="o">[]</span><span class="w"> </span><span class="p">{</span><span class="mf">1.f</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">};</span>
<span class="kd">var</span><span class="w"> </span><span class="n">floatTensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">stride</span><span class="p">(</span><span class="n">DType</span><span class="p">.</span><span class="na">FLOAT</span><span class="p">,</span><span class="w"> </span><span class="n">floatArray</span><span class="p">);</span>
<span class="n">floatTensor</span><span class="p">.</span><span class="na">sqr_</span><span class="p">();</span>
<span class="k">for</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">floatArray</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
4.0
9.0
16.0
</pre></div>
</div>
</div>
</div>
<p>Using a different type will not wrap the array, but will copy the data into a new darray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">doubleArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">stride</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">floatArray</span><span class="p">);</span>
<span class="n">doubleArray</span><span class="p">.</span><span class="na">sqrt_</span><span class="p">();</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">floatArray</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;original value at index[%d]: %f, corresponding darray value: %f%n&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                      </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">floatArray</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">doubleArray</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
<span class="p">}</span>
<span class="c1">// we can see that the values remain unchanged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>original value at index[0]: 1.000000, corresponding darray value: 1.000000
original value at index[1]: 4.000000, corresponding darray value: 2.000000
original value at index[2]: 9.000000, corresponding darray value: 3.000000
original value at index[3]: 16.000000, corresponding darray value: 4.000000
</pre></div>
</div>
</div>
</div>
<p>The are also other constructors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">eye</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;m: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>

<span class="n">Random</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;u: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;vector inner product between u and third row of m, which basically is the third element of u:&quot;</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">u</span><span class="p">.</span><span class="na">inner</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="na">selsq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)));</span>
<span class="n">println</span><span class="p">(</span><span class="n">u</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m: BaseStride{DOUBLE,[3, 3],0,[3, 1]}
[[ 1 0 0 ]  
 [ 0 1 0 ]  
 [ 0 0 1 ]] 

u: BaseStride{DOUBLE,[3],0,[1]}
[ 0.6054611363173034 0.47673188281383294 -0.49948335406718436 ] 

vector inner product between u and third row of m, which basically is the third element of u:
-0.49948335406718436
-0.49948335406718436
</pre></div>
</div>
</div>
</div>
<p>Since <code class="docutils literal notranslate"><span class="pre">m</span></code> is the identity matrix, it’s transpose is also identity,
matrix multiplication between the two produces also identity and
the determinant of <code class="docutils literal notranslate"><span class="pre">m</span></code> should be <code class="docutils literal notranslate"><span class="pre">1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">mtm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="na">t_</span><span class="p">().</span><span class="na">mm</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
<span class="n">display</span><span class="p">(</span><span class="s">&quot;text/markdown&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;$m^T m = I$&quot;</span><span class="p">);</span>
<span class="n">mtm</span><span class="p">.</span><span class="na">printContent</span><span class="p">();</span>
<span class="n">println</span><span class="p">(</span><span class="n">mtm</span><span class="p">.</span><span class="na">lu</span><span class="p">().</span><span class="na">det</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<p>$m^T m = I$</p>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1 0 0 ]  
 [ 0 1 0 ]  
 [ 0 0 1 ]] 
1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="stride-arrays">
<h2>Stride arrays<a class="headerlink" href="#stride-arrays" title="Permalink to this heading">#</a></h2>
<p>DArray base implementation uses stride array algebra. In short, all the elements of the darrays are stored in a storage which is a contiguous array. A darray is a view over the storage which defines a stride arithmetic. If operations allows to use the same storage (it is possible to perform the transformation manipulating only shape, offset and stride information), than it will create a new view. This allows fast operations if possible.</p>
<p>Let’s build an array which contains a sequence of numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">seq</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 3, 4],0,[12, 4, 1]}
[[[  0  1  2  3 ]   
  [  4  5  6  7 ]   
  [  8  9 10 11 ]]  
 [[ 12 13 14 15 ]   
  [ 16 17 18 19 ]   
  [ 20 21 22 23 ]]] 
</pre></div>
</div>
</div>
</div>
<p>Let’s dive a little bit into the description of the darray. <code class="docutils literal notranslate"><span class="pre">BaseStride</span></code> is the class which implements the darray, which means it uses stride arithmetic to index the values from storage. <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code> is the data type of the elements, in this case being <code class="docutils literal notranslate"><span class="pre">float</span></code> value type from Java.</p>
<p>Next we have some numeric information. <code class="docutils literal notranslate"><span class="pre">[2,3,4]</span></code> is the shape. This is to be expected, since we specified that shape when we created the darray. This means we have a darray with three dimensions, first axis of size <code class="docutils literal notranslate"><span class="pre">2</span></code>, second axis of size <code class="docutils literal notranslate"><span class="pre">3</span></code> and the third axis of size <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<p>The next information is the number <code class="docutils literal notranslate"><span class="pre">0</span></code>. This is the offset. The offset for a strided array is a position in the contiguous storage where the first element of the darray is stored. Sometimes this offset is not zero, and we will provide and example soon.</p>
<p>The last numeric information is <code class="docutils literal notranslate"><span class="pre">[12,4,1]</span></code>. These are the strides. We have a stride for each dimension in the darray. The meaning of stride is the following: <em>how many elements have to be skipped to see the next element in the given dimension</em>. The stride and offset gives a way to compute the position of an element in the storage, given an index for that element.</p>
<div class="math notranslate nohighlight">
\[ptr[i,j,k] = offset + i*stride[0] + j*stride[1] + k * stride[2]\]</div>
<p>The above formula is valid for three dimensions, of course. In general for <code class="docutils literal notranslate"><span class="pre">D</span></code> dimensions we have:</p>
<div class="math notranslate nohighlight">
\[ptr[i_0,i_1,..,i_{D-1}] = offset + \sum_{j=0}^{D-1} i_j * stride[j]\]</div>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> is a 3 dimensional array. The first dimension has size <code class="docutils literal notranslate"><span class="pre">2</span></code>. This allows the interpretation of <code class="docutils literal notranslate"><span class="pre">x</span></code> as being an array of 2 matrices of shape <code class="docutils literal notranslate"><span class="pre">[3,4]</span></code>. We can select an element based on an axis and index using <code class="docutils literal notranslate"><span class="pre">sel</span></code>. Furthermore, <code class="docutils literal notranslate"><span class="pre">selsq</span></code>, which is an abbreviation of <em>select and squeeze</em> removes the given axis from the darray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// first matrix</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">selsq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">selsq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[ 0 1  2  3 ]  
 [ 4 5  6  7 ]  
 [ 8 9 10 11 ]] 

BaseStride{DOUBLE,[3, 4],12,[4, 1]}
[[ 12 13 14 15 ]  
 [ 16 17 18 19 ]  
 [ 20 21 22 23 ]] 
</pre></div>
</div>
</div>
</div>
<p>Notice the offset of the second darray, which is <code class="docutils literal notranslate"><span class="pre">12</span></code>. The two darrays have the same shapes and strides, which means their layout in memory is the same, but their offset is different. This is because <code class="docutils literal notranslate"><span class="pre">x</span></code> is stored in C order (the default order in storage, but that can be changed also), which means it first stores the elements of the first matrix at offset <code class="docutils literal notranslate"><span class="pre">0</span></code> and after that it stores the elements of the second matrix at offset <code class="docutils literal notranslate"><span class="pre">12</span></code>, which is the same value as the number of elements of the first darray.</p>
<p>Multiple other operations on the layout creates different views on the same storage. General transposition, for example, creates the following darray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">.</span><span class="na">t_</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 3, 2],0,[1, 4, 12]}
[[[  0 12 ]   
  [  4 16 ]   
  [  8 20 ]]  
 [[  1 13 ]   
  [  5 17 ]   
  [  9 21 ]]  
 [[  2 14 ]   
  [  6 18 ]   
  [ 10 22 ]]  
 [[  3 15 ]   
  [  7 19 ]   
  [ 11 23 ]]] 
</pre></div>
</div>
</div>
</div>
<p>Notice how the shape dimensions are reversed, the same offset, but strides are different, since there are different dimension sizes. To check if two darrays have the same storage one have to compare the storage instances.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">storage</span><span class="p">());</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">t_</span><span class="p">().</span><span class="na">storage</span><span class="p">());</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">storage</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">t_</span><span class="p">().</span><span class="na">storage</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rapaio.darray.storage.array.DoubleArrayStorage@1a25a96d
rapaio.darray.storage.array.DoubleArrayStorage@1a25a96d
true
</pre></div>
</div>
</div>
</div>
<p><strong>Note on syntax:</strong>
Some methods have two variants, the first one named <code class="docutils literal notranslate"><span class="pre">operation</span></code> and the second one <code class="docutils literal notranslate"><span class="pre">operation_</span></code>, which is the same name ended with underscore. When the method name ends with underscore the operation works on the same storage as the original darray, when there is no ending underscore a new copy is created. Not all operations allows this syntax, since some are not able to work on the same storage and some others works only on the same storage.</p>
<p>When this syntax is used, both scenarios are implemented. This is valid for the transpose operation also. Notice the storage instance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">storage</span><span class="p">());</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">t_</span><span class="p">().</span><span class="na">storage</span><span class="p">());</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">t</span><span class="p">().</span><span class="na">storage</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rapaio.darray.storage.array.DoubleArrayStorage@1a25a96d
rapaio.darray.storage.array.DoubleArrayStorage@1a25a96d
rapaio.darray.storage.array.DoubleArrayStorage@183f682c
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-iterators">
<h2>Data iterators<a class="headerlink" href="#data-iterators" title="Permalink to this heading">#</a></h2>
<p>The elements of a darray can be accessed in multiple ways. One way is based on indexes. The index of an element is an array of semi-positive integer numbers, each less than its corresponding dimension. Thus the index of an element describes the order of that element in each dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DType</span><span class="p">.</span><span class="na">FLOAT</span><span class="p">;</span>
<span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[4, 5],0,[5, 1]}
[[ -0.5915424823760986   0.42765530943870544 1.301008701324463   -0.33507856726646423 -0.5955197215080261  ]  
 [ -0.09123338013887405  0.7820308804512024  1.400564193725586   -0.15987195074558258  0.6741945743560791  ]  
 [ -0.2882782518863678  -0.9254017472267151  0.23874905705451965 -0.8072279691696167   0.938342809677124   ]  
 [ -0.9454368948936462   0.22093218564987183 0.6785244941711426   0.17902342975139618  0.20195713639259338 ]] 
</pre></div>
</div>
</div>
</div>
<p>We have a matrix of <code class="docutils literal notranslate"><span class="pre">4</span></code> rows and <code class="docutils literal notranslate"><span class="pre">5</span></code> columns. To access the element from second row and third column we can use <code class="docutils literal notranslate"><span class="pre">get</span></code> methods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="c1">// if we want directly the value type</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">getFloat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="c1">// we can de a cast, also, if it is useful, notice that 0 is the rounded value of the original one</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4005642
1.4005642
1
</pre></div>
</div>
</div>
</div>
<p>To iterate on the elements using indexes one can use the following iterator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.4f, &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="na">next</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.5915, 0.4277, 1.3010, -0.3351, -0.5955, -0.0912, 0.7820, 1.4006, -0.1599, 0.6742, -0.2883, -0.9254, 0.2387, -0.8072, 0.9383, -0.9454, 0.2209, 0.6785, 0.1790, 0.2020, 
</pre></div>
</div>
</div>
</div>
<p>The default order is <code class="docutils literal notranslate"><span class="pre">Order.C</span></code> C-style order, which means last dimensions loops faster. In the case of the matrix we iterate first on rows, and after that, in the inner loop, we iterate over columns. So, in C order, columns loops faster than rows.</p>
<p>One can use also other orders, like <code class="docutils literal notranslate"><span class="pre">Order.F</span></code> Fortran-style order, which means first dimensions loops faster. There is also <code class="docutils literal notranslate"><span class="pre">Order.S</span></code> which is the storage order, the best possible order in which elements can be iterated so that accessing them is cache friendly. Also, <code class="docutils literal notranslate"><span class="pre">Order.A</span></code> means automatic order, which can be determined by an algorithm. We also have <code class="docutils literal notranslate"><span class="pre">Order.defaultOrder()</span></code> which is the configured default order, in our case being C.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">iterator</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="na">F</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.4f,&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="na">next</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.5915,-0.0912,-0.2883,-0.9454,0.4277,0.7820,-0.9254,0.2209,1.3010,1.4006,0.2387,0.6785,-0.3351,-0.1599,-0.8072,0.1790,-0.5955,0.6742,0.9383,0.2020,
</pre></div>
</div>
</div>
</div>
<p>Another kind of iterator is to iterate by pointer. The pointer of an element is basically the position of that element in the underlying storage. The advantage of using pointer elements is that it can be faster since some optimizations are realized if possible. To access elements based on their pointer value you can used <code class="docutils literal notranslate"><span class="pre">ptrGet</span></code> methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">pit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">ptrIterator</span><span class="p">();</span>
<span class="k">while</span><span class="p">(</span><span class="n">pit</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%.4f, &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">ptrGet</span><span class="p">(</span><span class="n">pit</span><span class="p">.</span><span class="na">next</span><span class="p">()));</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.5915, 0.4277, 1.3010, -0.3351, -0.5955, -0.0912, 0.7820, 1.4006, -0.1599, 0.6742, -0.2883, -0.9254, 0.2387, -0.8072, 0.9383, -0.9454, 0.2209, 0.6785, 0.1790, 0.2020, 
</pre></div>
</div>
</div>
</div>
</section>
<section id="operations-on-shapes">
<h2>Operations on shapes<a class="headerlink" href="#operations-on-shapes" title="Permalink to this heading">#</a></h2>
<p>In general we can consider that a darray is an organized indexed view over some data elements which are lies into a storage. Many operations on those objects changes only this organization of data. Some of the operations are able to create a new view over the same data and for some other this is impossible, and a new storage with copied data is necessary.</p>
<p>The idea of multidimensional array of elements can be seen in a recursive fashion. For example a darray in three dimensions can be understood as an indexed array of darrays of 2 dimensions, which in turn can be seen as arrays of unidimensional objects, which in a final turn can be seen as an indexed array of individual values, or scalars. As we can see this is a matter of organization, and this kind of operations helps us to give a proper form more usefull for understanding, for computation or for other reasons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">seq</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[2, 3, 2],0,[6, 2, 1]}
[[[  0  1 ]   
  [  2  3 ]   
  [  4  5 ]]  
 [[  6  7 ]   
  [  8  9 ]   
  [ 10 11 ]]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// split into pieces of the same size on the first dimension</span>
<span class="n">x</span><span class="p">.</span><span class="na">chunk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[BaseStride{FLOAT,[3, 2],0,[2, 1]}
[[ 0 1 ]  
 [ 2 3 ]  
 [ 4 5 ]] 
, BaseStride{FLOAT,[3, 2],6,[2, 1]}
[[  6  7 ]  
 [  8  9 ]  
 [ 10 11 ]] 
]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// split into pieces of the same size on first and last dimension</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">DArray</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">chunkAll</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="k">new</span><span class="w"> </span><span class="kt">int</span><span class="o">[]</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
<span class="n">list</span><span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">da</span><span class="o">-&gt;</span><span class="n">println</span><span class="p">(</span><span class="n">da</span><span class="p">.</span><span class="na">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[3],0,[2]}
[ 0 2 4 ] 

BaseStride{FLOAT,[3],1,[2]}
[ 1 3 5 ] 

BaseStride{FLOAT,[3],6,[2]}
[ 6 8 10 ] 

BaseStride{FLOAT,[3],7,[2]}
[ 7 9 11 ] 
</pre></div>
</div>
</div>
</div>
<p>Darrays can also be concatenated or stacked, operations which will produce new copies of data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// define some vectors</span>
<span class="kd">var</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[3],0,[1]}
[ 0.682409405708313 -1.860346794128418 -0.3640243411064148 ] 

BaseStride{FLOAT,[3],0,[1]}
[ 0.907001256942749 -0.2078128606081009 1.9437248706817627 ] 

BaseStride{FLOAT,[3],0,[1]}
[ 0.5633633732795715 -0.04871172457933426 -0.5485519170761108 ] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// stack all of them as rows in a matrix. </span>
<span class="n">dm</span><span class="p">.</span><span class="na">stack</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="o">&lt;</span><span class="n">DArray</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;&gt;</span><span class="n">of</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[3, 3],0,[3, 1]}
[[ 0.682409405708313  -1.860346794128418   -0.3640243411064148 ]  
 [ 0.907001256942749  -0.2078128606081009   1.9437248706817627 ]  
 [ 0.5633633732795715 -0.04871172457933426 -0.5485519170761108 ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// stack all of them as columns in a matrix</span>
<span class="n">dm</span><span class="p">.</span><span class="na">stack</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="o">&lt;</span><span class="n">DArray</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;&gt;</span><span class="n">of</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[3, 3],0,[3, 1]}
[[  0.682409405708313   0.907001256942749   0.5633633732795715  ]  
 [ -1.860346794128418  -0.2078128606081009 -0.04871172457933426 ]  
 [ -0.3640243411064148  1.9437248706817627 -0.5485519170761108  ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// concatenate all elements along the single available dimension of the elements</span>
<span class="n">dm</span><span class="p">.</span><span class="na">cat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="o">&lt;</span><span class="n">DArray</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;&gt;</span><span class="n">of</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[9],0,[1]}
[ 0.682409405708313 -1.860346794128418 -0.3640243411064148 0.907001256942749 -0.2078128606081009 1.9437248706817627 0.5633633732795715 -0.04871172457933426 -0.5485519170761108 ] 
</pre></div>
</div>
</div>
</div>
<p>Most of the operations which manipulates shapes are present, like repeat, select or remove by axis indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;x:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;first and last col of x:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">sel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">));</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;remove first two rows of x:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">rem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;select first col of x and repeat it 3 times:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">sel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span><span class="na">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x:BaseStride{FLOAT,[4, 3],0,[3, 1]}
[[  1.6434990167617798   0.9172410368919373   0.3495040833950043  ]  
 [ -0.3341809809207916  -0.35777759552001953 -0.1645195335149765  ]  
 [ -0.10719511657953262 -0.06851354241371155 -0.07772722095251083 ]  
 [  0.9436370730400085  -1.0320192575454712   0.9695566296577454  ]] 

first and last col of x:BaseStride{FLOAT,[4, 2],0,[3, 2]}
[[  1.6434990167617798   0.3495040833950043  ]  
 [ -0.3341809809207916  -0.1645195335149765  ]  
 [ -0.10719511657953262 -0.07772722095251083 ]  
 [  0.9436370730400085   0.9695566296577454  ]] 

remove first two rows of x:BaseStride{FLOAT,[2, 3],6,[3, 1]}
[[ -0.10719511657953262 -0.06851354241371155 -0.07772722095251083 ]  
 [  0.9436370730400085  -1.0320192575454712   0.9695566296577454  ]] 

select first col of x and repeat it 3 times:BaseStride{FLOAT,[4, 3],0,[3, 1]}
[[  1.6434990167617798   1.6434990167617798   1.6434990167617798  ]  
 [ -0.3341809809207916  -0.3341809809207916  -0.3341809809207916  ]  
 [ -0.10719511657953262 -0.10719511657953262 -0.10719511657953262 ]  
 [  0.9436370730400085   0.9436370730400085   0.9436370730400085  ]] 
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-interesting-case-of-stride-0">
<h2>The interesting case of stride 0<a class="headerlink" href="#the-interesting-case-of-stride-0" title="Permalink to this heading">#</a></h2>
<p>It is possible that sometimes you can see a <code class="docutils literal notranslate"><span class="pre">0</span></code> strided dimension. This is ok, and it means that values on that dimensions are repeated (read from the same place) by a number of times equal with the dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">scalar</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[],0,[]}
 2  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="na">strexp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">).</span><span class="na">strexp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{FLOAT,[3, 4],0,[0, 0]}
[[ 2 2 2 2 ]  
 [ 2 2 2 2 ]  
 [ 2 2 2 2 ]] 
</pre></div>
</div>
</div>
</div>
<p>In the example below we started from a scalar, which is a darray with no dimensions, and we added new dimensions (stretch) and expanded that dimensions by a number of times. In this case we added first dimension repeated three times and second dimension repeated four times. Notice the strides are all <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p><strong>Note</strong>:</p>
<p>During implementation of stride arithmetics I found that also negative strides are possible. Having a negative stride would mean that instead of adding a number of positions you would have to go back a number of positions in that dimension. However I had chosen to not allow this kind of flexibility. I could not foresee all the implications for all sorts of operations (the first reason), and the second reason was that many layout operations on strides become overly complicated (at least to my mind). It is a design decision and for now I see it as a fair price to lose some wild flexibility and buy some computation and stability.</p>
</section>
<section id="unary-operations">
<h2>Unary operations<a class="headerlink" href="#unary-operations" title="Permalink to this heading">#</a></h2>
<p>Unary operations are operations which are applied on each element and the order of processing elements is does not change the result. In most cases the processing is independent for each element, so a single pass over the indexed elements is enough. If the operation is not independent, additional passes over data might be required, but the order of precessing them is still not relevant.</p>
<p>This characteristic leaves some room for optimization since if we are free to process the elements in whatever order we want, we can work out the best order which is cache friendly and potentially vectorizable.</p>
<p>There are implemented plenty of unary operations, we illustrare here just with one example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DType</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">;</span>
<span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;x:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">swapAxis</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">).</span><span class="na">swapAxis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;y:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x:BaseStride{DOUBLE,[3, 4, 2],0,[8, 2, 1]}
[[[ -0.09966190499890398 -0.5811431434994926  ]   
  [ -0.8561254101627737  -0.9181375052182392  ]   
  [  1.1062313258059315  -0.03361855779440348 ]   
  [ -0.19940824264650267  0.3394637281444628  ]]  
 [[  0.5239940045886521  -0.4808024622381947  ]   
  [  0.18050084772155725 -0.32917346344484205 ]   
  [  1.135010764731621    0.8622715316732382  ]   
  [  0.295551483102627   -0.32032930267467846 ]]  
 [[  0.5165038632024493   1.3322719542251784  ]   
  [ -0.8554643292889054   0.8746757350332696  ]   
  [  0.32638451857295453 -0.09187350537981684 ]   
  [ -0.5084207394085699   0.10020556064469907 ]]] 

y:BaseStride{DOUBLE,[2, 3, 4],0,[1, 8, 2]}
[[[ -0.09966190499890398 -0.8561254101627737   1.1062313258059315  -0.19940824264650267 ]   
  [  0.5239940045886521   0.18050084772155725  1.135010764731621    0.295551483102627   ]   
  [  0.5165038632024493  -0.8554643292889054   0.32638451857295453 -0.5084207394085699  ]]  
 [[ -0.5811431434994926  -0.9181375052182392  -0.03361855779440348  0.3394637281444628  ]   
  [ -0.4808024622381947  -0.32917346344484205  0.8622715316732382  -0.32032930267467846 ]   
  [  1.3322719542251784   0.8746757350332696  -0.09187350537981684  0.10020556064469907 ]]] 
</pre></div>
</div>
</div>
</div>
<p>Notice how strides are not well aligned anymore. However appling unary operation is still fast since the elements are dense in memory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="na">log1p</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 3, 4],0,[12, 4, 1]}
[[[ 1.0648273146801222 0.7626147479516716 1.4125056554915065 1.0298307367635657 ]   
  [ 1.2595950067639308 1.157038683673884  1.4194899317930934 1.1925735236318604 ]   
  [ 1.2574672753583793 0.7629230584158948 1.2018859840021214 0.9129167506320462 ]]  
 [[ 0.8832950552182608 0.7332629232383152 1.0873428403711773 1.2058102336616128 ]   
  [ 0.9239404134152693 0.9823879887598992 1.3512554900985507 0.985693912840778  ]   
  [ 1.4660921051519407 1.3544619780220997 1.0675090575629782 1.1314684191780842 ]]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">.</span><span class="na">softmax1d</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 3, 4],0,[12, 4, 1]}
[[[ 0.17500473424725813 0.08213379149438037 0.5844704696385434  0.15839100461981817 ]   
  [ 0.2300244470890973  0.16315365705801513 0.42377487333569713 0.1830470225171904  ]   
  [ 0.4099551398262636  0.1039676243306248  0.3389756900440856  0.14710154579902585 ]]  
 [[ 0.16796293915289073 0.11991090312678258 0.2904025141609272  0.4217236435593994  ]   
  [ 0.1394973305941254  0.1623370069670688  0.5343865531909564  0.16377910924784933 ]   
  [ 0.46184977173043223 0.2922598926089767  0.11117374070414876 0.13471659495644225 ]]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">.</span><span class="na">softmax1d</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="na">sum1d</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">// not really 1 due to numerical precision, but very close</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 3],0,[3, 1]}
[[ 1.0000000000000002 0.9999999999999999 1 ]  
 [ 1                  0.9999999999999999 1 ]] 
</pre></div>
</div>
</div>
</div>
</section>
<section id="reduce-operations">
<h2>Reduce operations<a class="headerlink" href="#reduce-operations" title="Permalink to this heading">#</a></h2>
<p>A reduce operation is an operation which computes an aggregate over one or more dimensions. As an illustrative example consider the sum over all elements of a matrix. This is a reduce operation since from a 2-dimensional darray you get a scalar, which is a 0-dimensional darray. Some reduction does not necessary eliminate dimensions, but can make them shorter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;x: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;sum of all elements: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">sum</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x: BaseStride{DOUBLE,[2, 3],0,[3, 1]}
[[  0.21075724479804384 0.49088489464751806 0.14180302151996524 ]  
 [ -1.1965032080235163  0.22371030592334323 1.2543483166020575  ]] 
sum of all elements: 1.1250005754674115
</pre></div>
</div>
</div>
</div>
<p>The same sum can be also aplied along one dimension. This can be done using methods which ends with <code class="docutils literal notranslate"><span class="pre">1d</span></code>. If you have trouble imagining the effect, you can this that you choose an axis and the vectors along that axis collapses into a value and the dimension disapears.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">print</span><span class="p">(</span><span class="s">&quot;sum along rows:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">sum1d</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;sum along columns:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">sum1d</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sum along rows:BaseStride{DOUBLE,[3],0,[1]}
[ -0.9857459632254725 0.7145952005708613 1.3961513381220227 ] 
sum along columns:BaseStride{DOUBLE,[2],0,[1]}
[ 0.8434451609655271 0.28155541450188437 ] 
</pre></div>
</div>
</div>
</div>
<p>For the next operations we will take a more complex darray, a 3 dimensional one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 3, 4],0,[12, 4, 1]}
[[[ -0.19370948548938752 -1.6219526313603232    0.260846270192833   -0.9694227198510383  ]   
  [ -0.04455320489472237  0.1833842914682224    0.04337894930803018  0.5567989615040088  ]   
  [  0.4576310384809315   1.0412082739849728    0.7869073159101394  -0.5536995680293529  ]]  
 [[ -0.33321398706168714  0.013396092797920383 -0.5697525844043465   1.960093757917051   ]   
  [  0.1812215984156018  -1.1624209539265615   -0.16466583547336125  0.12356238454118097 ]   
  [  0.19354883880516652  0.6053793130368094    0.24314683149026525  0.9079797019272604  ]]] 
</pre></div>
</div>
</div>
</div>
<p><em>Aggregate on a shape</em> is an aggregation operation which takes all pieces from the darray of a given shape and reduces them in one value. This is basically a generalization of one dimensional reduction. There is a catch, however, the shape must match the last dimensions of the original shape. The on shape do not do broadcast, so you cannot use dimension size 1 (maybe this is an idea of improvement if there will be a need). Since the last dimensions collapses into a single value, the result will have the shape described by the first dimensions which are not subject to reduction. This operation allows a <code class="docutils literal notranslate"><span class="pre">keepDim</span></code> parameter which when set to <code class="docutils literal notranslate"><span class="pre">true</span></code> will keep the collapsed dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// sum on the last dimension</span>
<span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">sumOn</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">));</span>
<span class="c1">// sum over last two dimensions</span>
<span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">sumOn</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 3],0,[3, 1]}
[[ -2.5242385665079157  0.7390089973855389 1.7320470603466909 ]  
 [  1.0705232792489376 -1.0223028064431399 1.9500546852595015 ]] 
BaseStride{DOUBLE,[2],0,[1]}
[ -0.05318250877568642 1.998275158065299 ] 
</pre></div>
</div>
</div>
</div>
<p><em>Aggregate to a shape</em> does, somehow the opposite of aggregate on a shape. Using aggregate to a shape you specify actually the shape of the result, all other dimensions will collapse by reduction function into scalar values, placed in the requested shape. This operation allows broadcast. The specified shape must match the last dimensions of the original darray, but also can be 1, which means that the corresponding dimension will collapse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">.</span><span class="na">sumTo</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[ -0.5269234725510746  -1.6085565385624028 -0.3089063142115135  0.9906710380660126  ]  
 [  0.13666839352087942 -0.9790366624583391 -0.12128688616533106 0.6803613460451897  ]  
 [  0.651179877286098    1.646587587021782   1.0300541474004046  0.35428013389790747 ]] 
</pre></div>
</div>
</div>
</div>
<p>In the previous example, we get a reduced shape as requested. The reduced shape is a matrix and in each cell it contains the sum of the two corresponding elements. In this case you can imagine the darray as an array of two matrices. Since we collapse to the matrix shape, this is esentially like summing the two matrices.</p>
<p>But also some wild things can be done, like collapsing into the seond dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">.</span><span class="na">sumTo</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[3, 1],0,[1, 1]}
[[ -1.4537152872589783  ]  
 [ -0.28329380905760104 ]  
 [  3.6821017456061926  ]] 
</pre></div>
</div>
</div>
</div>
<p>Aggregate to a shape can perform the same thing as aggregate on a shape, you just have to specify the complementary indinces.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">sumOn</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="kc">false</span><span class="p">));</span>
<span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">sumTo</span><span class="p">(</span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">).</span><span class="na">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2],0,[1]}
[ -0.05318250877568642 1.998275158065299 ] 
BaseStride{DOUBLE,[2],0,[1]}
[ -0.05318250877568642 1.998275158065299 ] 
</pre></div>
</div>
</div>
</div>
<section id="gather-and-scatter">
<h3>Gather and scatter<a class="headerlink" href="#gather-and-scatter" title="Permalink to this heading">#</a></h3>
<p>Gather and scatter operations are somehow related to aggregation, but instead of values it operates with indices and acts only on a single dimension. If you read the documentation about gather and scatter you might have a hard time. I did, at least.</p>
<p>Instead of explaining how they works, my starting point of understanding those operations is to have an example. Let’s start with a matrix, since it has a simpler structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 3],0,[3, 1]}
[[ -0.682006135779255   0.33821119699907   -0.4130832314686386 ]  
 [  0.40062639975819253 0.8907595400657192  2.1836422240866504 ]  
 [  0.02150447967183535 1.633310274282907  -0.6218288849890282 ]  
 [  0.36831596448871595 1.5956642716994516  0.2272103401446834 ]] 
</pre></div>
</div>
</div>
</div>
<p>Now think that you need to take the maximum value from each row. That can be easily done with a reduce operation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// get the maximum value along columns, which is the maximum value from each row</span>
<span class="n">x</span><span class="p">.</span><span class="na">amax1d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4],0,[1]}
[ 0.33821119699907 2.1836422240866504 1.633310274282907 1.5956642716994516 ] 
</pre></div>
</div>
</div>
</div>
<p>This is simple, but what if you want to do something more complicated? Like for example to take the maximum value from each row, to multiply each maximum value by 100, and then to put those changed values back in their place?</p>
<p>We will do that in steps. First we take the index from each row of the maximum value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">argmax1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{INTEGER,[4, 1],0,[1, 1]}
[[ 1 ]  
 [ 2 ]  
 [ 1 ]  
 [ 1 ]] 
</pre></div>
</div>
</div>
</div>
<p>Now use the <code class="docutils literal notranslate"><span class="pre">gather</span></code> magic, which basically collects the values along the given axis from the corresponding indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">maxValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">gather</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">);</span>
<span class="n">maxValues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 1],0,[1, 1]}
[[ 0.33821119699907   ]  
 [ 2.1836422240866504 ]  
 [ 1.633310274282907  ]  
 [ 1.5956642716994516 ]] 
</pre></div>
</div>
</div>
</div>
<p>You can see that actually we obtained the same values as before. Why bother than? Because the index can be used also to put back the values. But first let’s do the processing, thus multiplication by 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">maxValues</span><span class="p">.</span><span class="na">mul_</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="n">maxValues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 1],0,[1, 1]}
[[  33.821119699907   ]  
 [ 218.36422240866506 ]  
 [ 163.3310274282907  ]  
 [ 159.56642716994514 ]] 
</pre></div>
</div>
</div>
</div>
<p>We used inplace version of the operation, no need to copy the data. Now we apply the <code class="docutils literal notranslate"><span class="pre">scatter</span></code> magic, which basically do the opposite of what gather does. Instead of taking values from a given indinces, the scatter operation puts values back at the given indices.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">maxValues</span><span class="p">.</span><span class="na">scatter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 3],0,[3, 1]}
[[ -0.682006135779255    33.821119699907      -0.4130832314686386 ]  
 [  0.40062639975819253   0.8907595400657192 218.36422240866506   ]  
 [  0.02150447967183535 163.3310274282907     -0.6218288849890282 ]  
 [  0.36831596448871595 159.56642716994514     0.2272103401446834 ]] 
</pre></div>
</div>
</div>
</div>
<p>This is it. To me this example was enough to understand what scatter and gather does, hope it is the same for you.</p>
</section>
</section>
<section id="binary-operations">
<h2>Binary operations<a class="headerlink" href="#binary-operations" title="Permalink to this heading">#</a></h2>
<p>Binary operations are operations which takes one input and produces a result. The binary operations for darray are as normal ones, with the addition of the fact that one of the operands can be also a scalar. Thus, instead of adding a value to all elements by expanding the scalar to a matrix of the same shape, you can also provide a value typed parameters. Some examples, are provided, but since this is not a complex topic it should be illustrative enough.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;x: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="kd">var</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;y: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x: BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[ -1.5285733087491937  -0.4708157963179278  0.33712668979949495 0.6056847504770257  ]  
 [ -1.8994827779694794   0.887362491692914  -0.29339256527527546 1.0316995525580686  ]  
 [  0.02861757909146721  0.8885850705432026  2.2750652617591403  0.12548109119679596 ]] 
y: BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[ -2.2505483550982075  -1.0151587362276921 -1.1018169293694524   0.4532518772748631 ]  
 [  0.49485598640562944  1.405763675179167  -0.22842427438078736  1.190918215680208  ]  
 [  1.498037582251328   -1.0610880720937954 -0.11719649520646738 -1.0454881406223726 ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// elementwise multiplication</span>
<span class="n">print</span><span class="p">(</span><span class="s">&quot;x*y: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">mul</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x*y: BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[  3.4401281456525226  0.4779527687861421 -0.37145189416336744  0.27452775019046893 ]  
 [ -0.939970423752592   1.2474219575383738  0.06701798383172258  1.2286697902505241  ]  
 [  0.0428702089920677 -0.942867019394016  -0.2666296750441555  -0.13118899271860457 ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// add first row of x to each row of y, no squeeze for broadcasting purposes</span>
<span class="n">y</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">sel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[ -3.779121663847401    -1.48597453254562   -0.7646902395699575   1.0589366277518888  ]  
 [ -1.0337173223435643    0.9349478788612391  0.10870241541870759  1.7966029661572338  ]  
 [ -0.030535726497865623 -1.5319038684117232  0.21993019459302757 -0.43980339014534686 ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// add first columns of x to all columns of y</span>
<span class="n">y</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="na">sel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[ -3.779121663847401  -2.5437320449768857 -2.630390238118646   -1.0753214314743307 ]  
 [ -1.40462679156385   -0.4937191027903125 -2.127907052350267   -0.7085645622892713 ]  
 [  1.5266551613427952 -1.0324704930023283 -0.08857891611500017 -1.0168705615309055 ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// multiply x by 10</span>
<span class="n">x</span><span class="p">.</span><span class="na">mul</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[3, 4],0,[4, 1]}
[[ -15.285733087491938  -4.7081579631792785  3.3712668979949494  6.056847504770257  ]  
 [ -18.994827779694795   8.87362491692914   -2.9339256527527544 10.316995525580685  ]  
 [   0.2861757909146721  8.885850705432025  22.750652617591403   1.2548109119679596 ]] 
</pre></div>
</div>
</div>
</div>
</section>
<section id="broadcasting">
<h2>Broadcasting<a class="headerlink" href="#broadcasting" title="Permalink to this heading">#</a></h2>
<p>Broadcasting is a useful this which is permitted by many operations. In general two or more darrays have shapes which allows broadcast if they can be expandedn into the same shape.</p>
<p>For that the shape dimensions are considered from the last to the first and are broadcastable if one of the following rules applies:</p>
<ul class="simple">
<li><p>dimension sizes are the same</p></li>
<li><p>if dimensions are different, than the different ones has to be equal with 1</p></li>
<li><p>if the dimension does not exist in some darrays</p></li>
</ul>
<p>For example those two shapes are compatible from a broadcast perspective: <code class="docutils literal notranslate"><span class="pre">[3,1]</span></code> and <code class="docutils literal notranslate"><span class="pre">[4,3,2]</span></code>. The final shape is <code class="docutils literal notranslate"><span class="pre">[4,3,2]</span></code>. Starting from the last dimensions of each shape we have:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> is fine since one of them is <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> and <code class="docutils literal notranslate"><span class="pre">3</span></code> is fine since they are equal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> and nothing is fine since in the first shape the dimension does not exists.</p></li>
</ul>
<p>Another example is <code class="docutils literal notranslate"><span class="pre">[3,1]</span></code> and <code class="docutils literal notranslate"><span class="pre">[4,3]</span></code>. The last dimension is fine since one of them is <code class="docutils literal notranslate"><span class="pre">1</span></code>, but the second dimension is not compatible since we have two non unit values which are not the same.</p>
</section>
<section id="matrix-decompositions">
<h2>Matrix decompositions<a class="headerlink" href="#matrix-decompositions" title="Permalink to this heading">#</a></h2>
<p>Some fundamental matrix decompositions are available. Usually those can be found as operations with an abbreviated name. Some examples includes singluar value decomposition (<code class="docutils literal notranslate"><span class="pre">svd</span></code>), eigenvalue decomposition (<code class="docutils literal notranslate"><span class="pre">eig</span></code>), or QR decomposition <code class="docutils literal notranslate"><span class="pre">qr</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 2],0,[2, 1]}
[[  0.6361279479926422  -0.6172197473748315  ]  
 [ -1.8181438301923445   1.1729386424067931  ]  
 [  0.07900276313914616  1.2447874059623922  ]  
 [ -1.9844997059415475  -0.10766658716227985 ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// singular value decomposition</span>
<span class="kd">var</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">svd</span><span class="p">().</span><span class="na">u</span><span class="p">();</span>
<span class="kd">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">svd</span><span class="p">().</span><span class="na">s</span><span class="p">();</span>
<span class="kd">var</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">svd</span><span class="p">().</span><span class="na">v</span><span class="p">();</span>

<span class="n">display</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
<span class="n">display</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="n">display</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>

<span class="c1">// reconstruction of x</span>
<span class="n">println</span><span class="p">(</span><span class="n">u</span><span class="p">.</span><span class="na">mm</span><span class="p">(</span><span class="n">s</span><span class="p">).</span><span class="na">mm</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="na">t</span><span class="p">()));</span>

<span class="n">println</span><span class="p">(</span><span class="s">&quot;rank of x: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">svd</span><span class="p">().</span><span class="na">rank</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 2],0,[2, 1]}
[[  0.2817638016148232  -0.20876224601690369 ]  
 [ -0.7271591597851701   0.24398018400409158 ]  
 [ -0.13972379508283667  0.762454625454768   ]  
 [ -0.6101851993679768  -0.561742769044637   ]] 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 2],0,[2, 1]}
[[ 2.9299797593408785 0                 ]  
 [ 0                  1.545263064412203 ]] 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 2],0,[2, 1]}
[[  0.921914748075446  0.3873928203787299 ]  
 [ -0.3873928203787299 0.921914748075446  ]] 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 2],0,[2, 1]}
[[  0.6361279479926425  -0.6172197473748319  ]  
 [ -1.8181438301923445   1.1729386424067934  ]  
 [  0.07900276313914617  1.244787405962392   ]  
 [ -1.9844997059415475  -0.10766658716227961 ]] 

rank of x: 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// QR decomposition</span>
<span class="n">x</span><span class="p">.</span><span class="na">qr</span><span class="p">().</span><span class="na">q</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 2],0,[2, 1]}
[[ -0.22992063054943812   0.26478107732655    ]  
 [  0.6571457474656174   -0.39553285632675306 ]  
 [ -0.028554578011262734 -0.774625348710149   ]  
 [  0.7172730347017114    0.4164136282489701  ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// q is orthogonal</span>
<span class="kd">var</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">qr</span><span class="p">().</span><span class="na">q</span><span class="p">();</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;norm of the first vector column: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">selsq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">).</span><span class="na">inner</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="na">selsq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)));</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;inner product of the two column vectors: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="na">selsq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">).</span><span class="na">inner</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="na">selsq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>norm of the first vector column: 1.0
inner product of the two column vectors: -1.1102230246251565E-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">qr</span><span class="p">().</span><span class="na">r</span><span class="p">();</span>
<span class="c1">// basic reconstruction</span>
<span class="n">println</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">q</span><span class="p">.</span><span class="na">mm</span><span class="p">(</span><span class="n">r</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 2],0,[2, 1]}
[[  0.6361279479926422  -0.6172197473748315  ]  
 [ -1.8181438301923445   1.1729386424067931  ]  
 [  0.07900276313914616  1.2447874059623922  ]  
 [ -1.9844997059415475  -0.10766658716227985 ]] 

BaseStride{DOUBLE,[4, 2],0,[2, 1]}
[[  0.6361279479926424  -0.6172197473748319  ]  
 [ -1.8181438301923445   1.1729386424067934  ]  
 [  0.07900276313914616  1.2447874059623922  ]  
 [ -1.9844997059415475  -0.10766658716227961 ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// compute inverse of a matrix using QR decomposition</span>
<span class="kd">var</span><span class="w"> </span><span class="n">xinv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">qr</span><span class="p">().</span><span class="na">inv</span><span class="p">();</span>
<span class="n">println</span><span class="p">(</span><span class="n">xinv</span><span class="p">);</span>
<span class="n">println</span><span class="p">(</span><span class="n">xinv</span><span class="p">.</span><span class="na">mm</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[2, 4],0,[4, 1]}
[[  0.036320585240459106 -0.16763468886331098 0.14718115937257473 -0.3328212975331378 ]  
 [ -0.16180294996768088   0.24170300842111697 0.4733596063833143  -0.2544628722630875 ]] 

BaseStride{DOUBLE,[2, 2],0,[2, 1]}
[[ 1                                0.000000000000000020816681711722 ]  
 [ 0.000000000000000111022302462516 0.9999999999999998               ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 4],0,[4, 1]}
[[ -0.49758468945193496 -1.0132661955212037   0.32412832230201005 -0.09621157577897815 ]  
 [  0.4697629891272382   0.1828448903276828   0.2929344449586873   0.5481846346779728  ]  
 [  0.540154011556269    0.048310210027802405 0.508817643512376   -0.6794242890120057  ]  
 [ -0.8353294656427067   0.22605997033318354  0.3121699630678687   1.1690569997934266  ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dm</span><span class="p">.</span><span class="na">random</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Shape</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="n">random</span><span class="p">);</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4],0,[1]}
[ 0.1134234001306074 1.9931310312370873 -1.0857473539685625 -0.4411475957936394 ] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">.</span><span class="na">mul</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 4],0,[4, 1]}
[[ -0.05643774733057084  -2.019572297196857   -0.35192146828567683  0.042443505342413756 ]  
 [  0.053282115482328904  0.36443382481524655 -0.31805279850014423 -0.24183033363920223  ]  
 [  0.06126610458489942   0.09628857873199409 -0.5524474100960816   0.2997263916214491   ]  
 [ -0.09474590822247919   0.45056714179160345 -0.3389377113894023  -0.5157266848045953   ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">.</span><span class="na">mul</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="na">stretch</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 4],0,[4, 1]}
[[ -0.05643774733057084 -0.11492809713341975   0.036763736394123364 -0.010912644056775294 ]  
 [  0.9362991909561889   0.36443382481524655   0.5838567323653723    1.092603806224034    ]  
 [ -0.5864707887827233  -0.052452682707351976 -0.5524474100960816    0.7376831240167571   ]  
 [  0.3685035854638656  -0.09972581241766536  -0.13771302868637947  -0.5157266848045953   ]] 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">.</span><span class="na">mul</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="na">stretch</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BaseStride{DOUBLE,[4, 4],0,[4, 1]}
[[ -0.05643774733057084  -2.019572297196857   -0.35192146828567683  0.042443505342413756 ]  
 [  0.053282115482328904  0.36443382481524655 -0.31805279850014423 -0.24183033363920223  ]  
 [  0.06126610458489942   0.09628857873199409 -0.5524474100960816   0.2997263916214491   ]  
 [ -0.09474590822247919   0.45056714179160345 -0.3389377113894023  -0.5157266848045953   ]] 
</pre></div>
</div>
</div>
</div>
</section>
<section id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">#</a></h2>
<p>Unfortunatelly there is not solid documentation other than the javadoc and that is still not complete. My personal take on that is to complete the javadoc documentation after a solidification of the API, and I still want to use it more to be content with how methods looks like. So I cannot send you to read the documentation. But if you are like me, you should take a look on the source code. The file which declares the methods from a darray has more than two thousand lines of code. There are plenty of methods implemented. It needs time to document all of that.</p>
<p>But if you still survived up until this moment, I hope you will have enough courage to play with the sources and the library itself. If you do, please let me know and if yo</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "rapaio-jupyter-kernel-preview23"
        },
        kernelOptions: {
            name: "rapaio-jupyter-kernel-preview23",
            path: "./tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'rapaio-jupyter-kernel-preview23'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ReadingAndWritingData.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Reading and Writing data</p>
      </div>
    </a>
    <a class="right-next"
       href="NeuralNetworks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tensors and Neural Networks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#darraymanager">DArrayManager</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shape-of-a-darray">Shape of a DArray</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#darray-creation">DArray creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stride-arrays">Stride arrays</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-iterators">Data iterators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operations-on-shapes">Operations on shapes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-interesting-case-of-stride-0">The interesting case of stride 0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unary-operations">Unary operations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduce-operations">Reduce operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gather-and-scatter">Gather and scatter</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-operations">Binary operations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">Broadcasting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-decompositions">Matrix decompositions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aurelian Tutuianu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>